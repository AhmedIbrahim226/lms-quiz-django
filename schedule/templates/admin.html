<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    </head>
    <body>
        {% for post in posts %}
            <embed src="{{ post.post_file.url }}" type="" width="1000px" height="300px" style="margin-left: 60px;">
        {% endfor %}
        <!-- <embed src="/home/ahmed/Desktop/LMS_PROJECT/database_v1_before_heroku/media/posts/2022/03/01/test.txt"  type="" width="1000px" height="500px" style="margin-left: 60px;"> -->


        <!-- <table class="table table-success table-hover mt-5 container">
            <tbody>
                <tr>
                    <th>User</th>
                    <th>Title</th>
                    <th>File</th>
                    <th>Description</th>
                    <th>Company-name</th>
                    <th>Created-on</th>
                    <th>Edit</th>
                </tr>
                {% for post in posts %}
                    <tr>
                        <td>{{post.user_have_post}}</td>
                        <td>{{post.post_title}}</td>
                        <td><a href="{{ post.post_file.url }}">{{post.post_file}}</a></td>
                        <td>{{post.post_description}}</td>
                        <td>{{post.company_name}}</td>
                        <td>{{post.created_on}}</td>
                        <td><a class="btn btn-outline-success" href="{% url 'admin-edit-post' post.id %}">update</a></td>
                    </tr>                    
                {% endfor %}
            </tbody>
        </table> -->

        
        <button id="btn1">Manage post</button>

		
        
        

        <div id="div1" style="margin-left: 25%;">
        </div>

        

        <script>
            let formData = new FormData()

            $('#btn1').click(function(e){
                $('#div1').html(`
                <form id="formNewPost" action="" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit">Save</button>
                </form>
                `)
            })


            $(document).on('submit', '#formNewPost', function(e){
                e.preventDefault()
                formData.append('user_have_post', $('#id_user_have_post').val())
                formData.append('post_title', $('#id_post_title').val())
                formData.append('post_file', $('#id_post_file')[0].files[0])
                formData.append('post_description', $('#id_post_description').val())
                formData.append('company_name', $('#id_company_name').val())
                formData.append('csrfmiddlewaretoken', $('input[name=csrfmiddlewaretoken]').val())
                $.ajax({
                    url: '/post/',
                    method: 'POST',
                    data: formData,

                    cache: false,
                    processData: false,
                    contentType: false,
                    enctype:"multipart/form-data",

                    success: function(response){
                        console.log(response)
                    }
                })
                
            })
            
        </script>

    </body>
</html>


